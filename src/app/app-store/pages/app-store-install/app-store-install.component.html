<div class="dark:border-primary-darker flex items-center justify-between border-b px-4 py-4 lg:py-6">
  <h1 class="text-2xl font-semibold flex-grow">{{ 'pages.appstore.install.title' | translate }}: {{ app?.name }}</h1>
  <a
    class="hover:bg-primary-dark focus:ring-primary dark:focus:ring-offset-dark rounded-md bg-green-700 px-4 py-2 text-sm text-white focus:outline-none focus:ring focus:ring-offset-1 focus:ring-offset-white mx-2"
    [routerLink]="['../../']"
  >
    {{ 'pages.appstore.title' | translate }}
  </a>
  <a
    class="hover:bg-primary-dark focus:ring-primary dark:focus:ring-offset-dark rounded-md bg-green-700 px-4 py-2 text-sm text-white focus:outline-none focus:ring focus:ring-offset-1 focus:ring-offset-white"
  >
    {{ 'common.refresh' | translate }}
  </a>
</div>

<form [formGroup]="appInstallForm">
  <div class="flex flex-col-reverse xl:flex-row p-1 xs:p-2 sm:p-2 md:p-4 gap-3">
    <div class="w-full">
      <div class="mt-3 dark:bg-darker flex flex-col rounded-md bg-white p-10">
        <form [formGroup]="appInstallForm">
          <!-- <div class="mt-3">
            <h5>{{ 'pages.appstore.install.clusters' | translate }}</h5>
            <app-input-dropdown
              [options]="(clusters$ | async)?.data"
              [couldOverride]="true"
              placeholder="{{ 'pages.create.cluster.steps.location.ownergroupPlaceholder' | translate }}"
              [controlName]="'cluster'"
              [formGroup]="appInstallForm"
              filterBy="clsterName"
              [showClear]="true"
              optionLabel="clusterName"
              optionValue="clusterName"
              emptyListMessage="{{ 'common.emptyList' | translate }}"
            ></app-input-dropdown>
            <span
              *ngIf="appInstallForm.get('cluster').touched && appInstallForm.get('cluster').dirty && appInstallForm.get('cluster').errors"
              class="text-red-400"
              >{{ 'pages.create.cluster.steps.location.ownergroupError' | translate }}</span
            >
          </div> -->
          <div class="flex flex-col mt-3">
            <h5>{{ 'pages.appstore.install.clusters' | translate }}</h5>
            <p-dropdown
              [options]="(clusters$ | async)?.data"
              placeholder="{{ 'pages.appstore.install.clustersPlaceholder' | translate }}"
              optionLabel="clusterName"
              [showClear]="true"
              formControlName="cluster"
              [filter]="true"
              filterBy="clusterId"
              (onChange)="clusterSelected($event)"
            >
              <ng-template let-cluster pTemplate="item">
                <div class="flex flex-col justify-stretch w-[500px]">
                  <span class="text-lg">{{ cluster?.clusterName }} </span>
                  <span>({{ cluster?.clusterId }})</span>
                </div>
              </ng-template>
            </p-dropdown>
            <span
              *ngIf="appInstallForm.get('cluster').touched && appInstallForm.get('cluster').dirty && appInstallForm.get('cluster').errors"
              class="text-red-400"
              >{{ 'pages.create.cluster.steps.metadata.sensitivityError' | translate }}</span
            >
            <!-- <div class="mt-1">
              <a href="https://docs.nhn.no/k8s/brukerdokumentasjon/obs/os_dashboard.html#tags" target="_blank" class="flex hover:text-green-500">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-6 w-6">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"
                  />
                </svg>
                <span>{{ 'pages.clusters.details.edit.form.moreInfo' | translate }}</span>
              </a>
            </div> -->
          </div>
          <div class="mt-3">
            <div class="w-full md:w-1/3">
              <h5>{{ 'pages.appstore.install.namespace' | translate }}</h5>
              <div class="flex flex-col">
                <input
                  class="p-inputtext-lg border text-lg"
                  type="text"
                  pInputText
                  formControlName="namespace"
                  [autofocus]="true"
                  (input)="namespaceSelected($event)"
                />
                <span
                  *ngIf="
                    (appInstallForm.get('namespace').errors || appInstallForm.get('namespace').errors) &&
                    appInstallForm.get('namespace').touched &&
                    appInstallForm.get('namespace').dirty
                  "
                  class="text-red-400"
                  >{{ 'pages.appstore.install.namespaceError' | translate }}
                </span>
              </div>
            </div>
          </div>
          <div class="mt-3">
            <div class="w-full">
              <h5>{{ 'pages.appstore.install.valuesOverride' | translate }}</h5>
              <div class="flex flex-col">
                <ngx-monaco-editor
                  [options]="editorOptions"
                  [(ngModel)]="code"
                  [ngModelOptions]="{ standalone: true }"
                  class="h-full w-full"
                ></ngx-monaco-editor>
              </div>
            </div>
          </div>
          <div class="mt-5 flex">
            <button
              [disabled]="!appInstallForm?.valid"
              (click)="installApp()"
              class="hover:bg-primary-dark focus:ring-primary dark:focus:ring-offset-dark rounded-md bg-green-700 px-4 py-2 text-sm text-white focus:outline-none focus:ring focus:ring-offset-1 focus:ring-offset-white disabled:bg-gray-500 disabled:hover:bg-gray-800"
            >
              {{ 'pages.appstore.install.submit' | translate }}
            </button>

            <button
              (click)="reset()"
              class="hover:bg-primary-lighter focus:ring-primary dark:focus:ring-offset-dark ml-3 rounded-md bg-neutral-500 px-4 py-2 text-sm text-white focus:outline-none focus:ring focus:ring-offset-1 focus:ring-offset-white"
            >
              {{ 'common.reset' | translate }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</form>
<p-toast></p-toast>
