import { Component, ViewChild } from '@angular/core';
import { VulnerabilityReportsByClusterComponent, VulnerabilityReportsByCveComponent } from '..';
import { TranslateModule } from '@ngx-translate/core';
import { CommonModule } from '@angular/common';
import { ExportComponent } from '../../../shared/components';
import { TabsModule } from 'primeng/tabs';

@Component({
  selector: 'app-vulnerability-reports',
  templateUrl: './vulnerability-reports.component.html',
  styleUrls: ['./vulnerability-reports.component.scss'],
  providers: [],
  imports: [
    TranslateModule,
    CommonModule,
    TabsModule,
    ExportComponent,
    VulnerabilityReportsByCveComponent,
    VulnerabilityReportsByClusterComponent,
  ],
})
export class VulnerabilityReportsComponent {
  @ViewChild('clustertable') clustertable: VulnerabilityReportsByClusterComponent;
  @ViewChild('cvetable') cvetable: any;
  summaryPerCluster: any[] = [];
  summaryById: any[] = [];
  activeIndex: number = 0;

  updateSummaryPerCluster(event: any[]): void {
    this.summaryPerCluster = event;
  }

  updateSummaryById(event: any[]): void {
    this.summaryById = event;
  }

  exportReport(): any[] {
    if (this.activeIndex === 0) {
      return this.summaryPerCluster;
    } else {
      return this.summaryById;
    }
  }

  refresh(): void {
    if (this.activeIndex === 0) {
      this.clustertable?.getVulnerabilityReports();
    } else {
      this.cvetable?.getVulnerabilityReports();
    }
  }
}
